<div fxLayout="row" fxLayoutGap="20px" fxLayout.xs="column">
    <sf-settings-nav fxFlex="25%" activeLink="test-order"></sf-settings-nav>
    <div fxLayout="column" fxLayoutGap="20px" fxFlex="75%" class="cards-container">
        <form #form="ngForm">
            <mat-card>
                <mat-card-content fxLayout="row wrap" fxLayoutGap="25px">
                    <mat-form-field appearance="outline" color="accent" fxFlex="25%">
                        <mat-label i18n>Channel</mat-label>
                        <mat-select [(value)]="order.channel">
                            <mat-option *ngFor="let channel of channels" [value]="channel.id">{{channel.name}}
                            </mat-option>
                            <mat-option *ngIf="!channels" disabled i18n>Loading...</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field appearance="outline" color="accent" fxFlex="25%">
                        <mat-label i18n>Carrier</mat-label>
                        <input matInput name="carrier" [(ngModel)]="order.shipment.carrier">
                    </mat-form-field>
                    <mat-form-field appearance="outline" color="accent" fxFlex="25%">
                        <mat-label i18n>Payment</mat-label>
                        <input matInput name="payment" [(ngModel)]="order.shipment.paymentMethod">
                    </mat-form-field>
                    <mat-form-field appearance="outline" color="accent" fxFlex="25%">
                        <mat-label i18n>Relay Number</mat-label>
                        <input matInput name="relay" type="number" [(ngModel)]="order.shipment.relayNumber">
                    </mat-form-field>
                </mat-card-content>
            </mat-card>
            <mat-card>
                <mat-card-content>
                    <table>
                        <tr>
                            <th i18n required>SKU</th>
                            <th i18n>Qty</th>
                            <th i18n required>Price</th>
                        </tr>
                        <tr *ngFor="let item of order.items; index as i">
                            <td>
                                <mat-form-field>
                                    <input name="itemReference{{i}}" matInput [(ngModel)]="item.reference" required
                                           #itemReference="ngModel">
                                    <mat-error *ngIf="itemReference.invalid && (itemReference.dirty || itemReference.touched)" i18n>
                                        Please, specify SKU
                                    </mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field>
                                    <input name="itemQuantity{{i}}" matInput [(ngModel)]="item.quantity">
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field>
                                    <input name="itemPrice{{i}}" matInput type="number" [(ngModel)]="item.price"
                                           (change)="updateTotalPrice()" required #itemPrice="ngModel">
                                    <mat-error *ngIf="itemPrice.invalid && (itemPrice.dirty || itemPrice.touched)" i18n>
                                        Please, specify price
                                    </mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <button mat-button class="add-item" *ngIf="i < order.items.length - 1"
                                        (click)="removeItem(i); updateTotalPrice();">
                                    <mat-icon class="mat-18">remove</mat-icon>
                                </button>
                                <button mat-button class="add-item" *ngIf="i === order.items.length - 1"
                                        (click)="addItem()">
                                    <mat-icon class="mat-18">add</mat-icon>
                                </button>
                            </td>
                        </tr>
                        <tr class="totals">
                            <td>
                                <div>
                                    <div i18n>Product total</div>
                                    <div i18n>Delivery cost</div>
                                    <div i18n class="mat-body-2">Total</div>
                                </div>
                            </td>
                            <td>
                            </td>
                            <td>
                                <div>
                                    <div>{{order.items.length}}</div>
                                    <mat-form-field><input type="number"
                                                           matInput name="shippingCost" (change)="updateTotalPrice()"
                                                           [(ngModel)]="order.shipment.shippingAmount"></mat-form-field>
                                    <div class="mat-body-2">{{totalPrice}}</div>
                                </div>
                            </td>
                            <td></td>
                        </tr>
                    </table>
                    <div fxLayout="row" fxLayoutAlign="flex-end center">
                        <button mat-button color="accent" i18n>Cancel</button>
                        <button mat-raised-button color="accent" i18n (click)="create()">Create</button>
                    </div>
                </mat-card-content>
            </mat-card>
        </form>
    </div>
</div>